var e=(e,a,l)=>new Promise(((o,d)=>{var t=e=>{try{s(l.next(e))}catch(a){d(a)}},n=e=>{try{s(l.throw(e))}catch(a){d(a)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(t,n);s((l=l.apply(e,a)).next())}));import{e as a,_ as l,r as o,n as d,x as t,y as n,Q as s,f as u,o as i,c as r,b as m,s as p,l as _,i as c}from"./index.92ac8ad6.js";import{g as f,d as h,a as v,e as y}from"./system.3c0e1678.js";import"./vendor.7f0cd297.js";var w=a({name:"Node",components:{YoungDialog:l},setup(){let a=o(!1),l=o(!1);const u=o(new Set),i=o({autoid:0,node_name:"",node_desc:"",node_path:"",node_sort:0,is_show:1,parent_id:0});let r=o([]);const m=()=>e(this,null,(function*(){sessionStorage.setItem("system_open_keys",JSON.stringify([...u.value]));const e=yield f();r.value=t(e);const a=sessionStorage.getItem("system_open_keys");u.value=new Set(JSON.parse(a))}));d((()=>m()));const p=()=>{a.value=!1,l.value=!1,i.value={autoid:0,node_name:"",node_desc:"",node_path:"",node_sort:0,is_show:1,parent_id:0},r.value=[],m()};return{add:e=>{let l=0;"object"==typeof e&&(3===e.node_type&&(i.value.is_show=0),l=e.autoid),i.value.parent_id=l,a.value=!0},edit:a=>e(this,null,(function*(){l.value=!0,i.value=a,i.value.node_id=a.autoid})),del:a=>{n.confirm("确认删除该节点？","提示",{type:"warning"}).then((()=>e(this,null,(function*(){yield h(a.autoid),s.success("节点删除成功！"),m()})))).catch((()=>null))},sure:()=>e(this,null,(function*(){a.value?(yield v(i.value),s.success("节点添加成功！")):l.value&&(yield y(i.value),s.success("节点修改成功！")),p()})),clear:p,form:i,tableData:r,isAdd:a,isEdit:l,expandKeys:u,expandChange:(...e)=>{const[a,l]=e,o=a.autoid;l?u.value.add(o):u.value.delete(o)},getRowKey:e=>e.autoid}}});const b={class:"index"},V={class:"caozuoFat"},g=c("添加一级节点"),x=c("编辑"),C=c("删除"),k=c("添加子节点"),U=c("隐藏"),S=c("显示");w.render=function(e,a,l,o,d,t){const n=u("el-button"),s=u("el-table-column"),c=u("el-switch"),f=u("el-table"),h=u("el-input"),v=u("el-form-item"),y=u("el-radio"),w=u("el-form"),D=u("young-dialog");return i(),r("div",b,[m("div",V,[m(n,{type:"primary",size:"small",plain:"",onClick:a[1]||(a[1]=a=>e.add(0))},{default:p((()=>[g])),_:1})]),_(" 节点列表 "),m(f,{data:e.tableData,style:{width:"100%","margin-bottom":"20px"},size:"medium","tree-props":{children:"part",hasChildren:"hasChildren"},"row-key":e.getRowKey,"expand-row-keys":[...e.expandKeys],onExpandChange:e.expandChange},{default:p((()=>[m(s,{prop:"node_name",label:"节点名称",width:"240"}),m(s,{prop:"autoid",label:"ID"}),m(s,{prop:"parent_id",label:"父节点"}),m(s,{prop:"node_path",label:"路径"}),m(s,{prop:"node_desc",label:"节点描述"}),m(s,{prop:"is_show",label:"隐藏/显示"},{default:p((e=>[m(c,{modelValue:e.row.is_show,"onUpdate:modelValue":a=>e.row.is_show=a,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),m(s,{prop:"node_type",label:"节点级别"}),m(s,{label:"操作",width:"300"},{default:p((a=>[m(n,{onClick:l=>e.edit(a.row)},{default:p((()=>[x])),_:2},1032,["onClick"]),m(n,{type:"danger",onClick:l=>e.del(a.row)},{default:p((()=>[C])),_:2},1032,["onClick"]),a.row.node_type<4?(i(),r(n,{key:0,type:"success",plain:"",onClick:l=>e.add(a.row)},{default:p((()=>[k])),_:2},1032,["onClick"])):_("v-if",!0)])),_:1})])),_:1},8,["data","row-key","expand-row-keys","onExpandChange"]),_(" 添加 / 编辑 "),m(D,{width:"370px","is-add":e.isAdd,"is-edit":e.isEdit,onSure:e.sure,onClear:e.clear},{body:p((()=>[m(w,{model:e.form,"label-width":"80px"},{default:p((()=>[m(v,{label:"节点名称"},{default:p((()=>[m(h,{modelValue:e.form.node_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.node_name=a)},null,8,["modelValue"])])),_:1}),m(v,{label:"节点描述"},{default:p((()=>[m(h,{modelValue:e.form.node_desc,"onUpdate:modelValue":a[3]||(a[3]=a=>e.form.node_desc=a)},null,8,["modelValue"])])),_:1}),m(v,{label:"节点路径"},{default:p((()=>[m(h,{modelValue:e.form.node_path,"onUpdate:modelValue":a[4]||(a[4]=a=>e.form.node_path=a)},null,8,["modelValue"])])),_:1}),m(v,{label:"排序(升序)"},{default:p((()=>[m(h,{modelValue:e.form.node_sort,"onUpdate:modelValue":a[5]||(a[5]=a=>e.form.node_sort=a),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),m(v,{label:"显示|隐藏"},{default:p((()=>[m(y,{modelValue:e.form.is_show,"onUpdate:modelValue":a[6]||(a[6]=a=>e.form.is_show=a),label:0},{default:p((()=>[U])),_:1},8,["modelValue"]),m(y,{modelValue:e.form.is_show,"onUpdate:modelValue":a[7]||(a[7]=a=>e.form.is_show=a),label:1},{default:p((()=>[S])),_:1},8,["modelValue"])])),_:1}),m(v,{label:"父节点ID"},{default:p((()=>[m(h,{modelValue:e.form.parent_id,"onUpdate:modelValue":a[8]||(a[8]=a=>e.form.parent_id=a),disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["is-add","is-edit","onSure","onClear"])])};export default w;
