var e=(e,l,a)=>new Promise(((o,d)=>{var t=e=>{try{n(a.next(e))}catch(l){d(l)}},u=e=>{try{n(a.throw(e))}catch(l){d(l)}},n=e=>e.done?o(e.value):Promise.resolve(e.value).then(t,u);n((a=a.apply(e,l)).next())}));import{d as l,f as a,I as o,g as d,o as t,c as u,b as n,l as s,x as i,u as r,q as p,F as m,S as c}from"./vendor.01d1481d.js";import{d as _,f as v,h,i as f}from"./system.95e8d616.js";import{d as w,i as y}from"./index.40da5c4d.js";const b={class:"index"},V={class:"caozuoFat"},k=p("添加一级节点"),g=p("编辑"),x=p("删除"),C=p("添加子节点"),U=p("隐藏"),S=p("显示");var I=l({setup(l){const p={autoid:0,node_name:"",node_desc:"",node_path:"",node_sort:0,is_show:1,parent_id:0},I=a(!1),j=a(!1),F=a(new Set);let z=[];const E=(e,l)=>{1===l&&(z=[]);for(const a of e)z.push(a.autoid+""),y(a.part)&&a.part.length>0&&E(w(a.part));return z},D=(...e)=>{const[l,a]=e,o=l.autoid;if(a)F.value.add(o+"");else{E([l],1).forEach((e=>F.value.delete(e)))}},J=a(w(p));let N=a([]);const O=()=>e(this,null,(function*(){sessionStorage.setItem("system_open_keys",JSON.stringify([...F.value]));const e=yield _();N.value=w(e);const l=sessionStorage.getItem("system_open_keys");F.value=new Set(JSON.parse(l))}));o((()=>O()));const P=e=>{let l=0;"object"==typeof e&&(3===e.node_type&&(J.value.is_show=0),l=e.autoid),J.value.parent_id=l,I.value=!0},q=l=>e(this,null,(function*(){j.value=!0,J.value=l,J.value.node_id=l.autoid})),M=l=>{m.confirm("确认删除该节点？","提示",{type:"warning"}).then((()=>e(this,null,(function*(){yield v(l.autoid),c.success("节点删除成功！"),O()})))).catch((()=>null))},A=()=>{I.value=!1,j.value=!1,J.value=w(p),N.value=[],O()},B=()=>e(this,null,(function*(){I.value?(yield h(J.value),c.success("节点添加成功！")):j.value&&(yield f(J.value),c.success("节点修改成功！")),A()}));return(e,l)=>{const a=d("el-button"),o=d("el-table-column"),p=d("el-switch"),m=d("el-table"),c=d("el-input"),_=d("el-form-item"),v=d("el-radio"),h=d("el-form"),f=d("young-dialog");return t(),u("div",b,[n("div",V,[n(a,{type:"primary",size:"small",plain:"",onClick:l[1]||(l[1]=e=>P(0))},{default:s((()=>[k])),_:1})]),i(" 节点列表 "),n(m,{data:r(N),style:{width:"100%","margin-bottom":"20px"},size:"medium","tree-props":{children:"part",hasChildren:"hasChildren"},"row-key":"autoid","expand-row-keys":[...F.value],onExpandChange:D},{default:s((()=>[n(o,{prop:"node_name",label:"节点名称",width:"240"}),n(o,{prop:"autoid",label:"ID"}),n(o,{prop:"parent_id",label:"父节点"}),n(o,{prop:"node_path",label:"路径"}),n(o,{prop:"node_desc",label:"节点描述"}),n(o,{prop:"is_show",label:"隐藏/显示"},{default:s((e=>[n(p,{modelValue:e.row.is_show,"onUpdate:modelValue":l=>e.row.is_show=l,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),n(o,{prop:"node_type",label:"节点级别"}),n(o,{label:"操作",width:"300"},{default:s((e=>[n(a,{onClick:l=>q(e.row)},{default:s((()=>[g])),_:2},1032,["onClick"]),n(a,{type:"danger",onClick:l=>M(e.row)},{default:s((()=>[x])),_:2},1032,["onClick"]),e.row.node_type<4?(t(),u(a,{key:0,type:"success",plain:"",onClick:l=>P(e.row)},{default:s((()=>[C])),_:2},1032,["onClick"])):i("v-if",!0)])),_:1})])),_:1},8,["data","expand-row-keys"]),i(" 添加 / 编辑 "),n(f,{width:"370px","is-add":I.value,"is-edit":j.value,onSure:B,onClear:A},{body:s((()=>[n(h,{model:J.value,"label-width":"80px"},{default:s((()=>[n(_,{label:"节点名称"},{default:s((()=>[n(c,{modelValue:J.value.node_name,"onUpdate:modelValue":l[2]||(l[2]=e=>J.value.node_name=e)},null,8,["modelValue"])])),_:1}),n(_,{label:"节点描述"},{default:s((()=>[n(c,{modelValue:J.value.node_desc,"onUpdate:modelValue":l[3]||(l[3]=e=>J.value.node_desc=e)},null,8,["modelValue"])])),_:1}),n(_,{label:"节点路径"},{default:s((()=>[n(c,{modelValue:J.value.node_path,"onUpdate:modelValue":l[4]||(l[4]=e=>J.value.node_path=e)},null,8,["modelValue"])])),_:1}),n(_,{label:"排序(升序)"},{default:s((()=>[n(c,{modelValue:J.value.node_sort,"onUpdate:modelValue":l[5]||(l[5]=e=>J.value.node_sort=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),n(_,{label:"显示|隐藏"},{default:s((()=>[n(v,{modelValue:J.value.is_show,"onUpdate:modelValue":l[6]||(l[6]=e=>J.value.is_show=e),label:0},{default:s((()=>[U])),_:1},8,["modelValue"]),n(v,{modelValue:J.value.is_show,"onUpdate:modelValue":l[7]||(l[7]=e=>J.value.is_show=e),label:1},{default:s((()=>[S])),_:1},8,["modelValue"])])),_:1}),n(_,{label:"父节点ID"},{default:s((()=>[n(c,{modelValue:J.value.parent_id,"onUpdate:modelValue":l[8]||(l[8]=e=>J.value.parent_id=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["is-add","is-edit"])])}}});export default I;
