var e=(e,a,l)=>new Promise(((o,d)=>{var t=e=>{try{s(l.next(e))}catch(a){d(a)}},n=e=>{try{s(l.throw(e))}catch(a){d(a)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(t,n);s((l=l.apply(e,a)).next())}));import{d as a,g as l,I as o,z as d,w as t,h as n,o as s,c as u,e as i,l as r,u as m,n as p}from"./vendor.e5bbabeb.js";import{g as c,d as _,a as f,e as h}from"./system.df1cc0fb.js";import{a as v,d as b,i as w}from"./index.d551fdd8.js";var y=a({name:"Node",components:{YoungDialog:v},setup(){let a=l(!1),n=l(!1);const s=l(new Set);let u=[];const i=(e,a)=>{1===a&&(u=[]);for(const l of e)u.push(l.autoid+""),w(l.part)&&l.part.length>0&&i(b(l.part));return u},r=l({autoid:0,node_name:"",node_desc:"",node_path:"",node_sort:0,is_show:1,parent_id:0});let m=l([]);const p=()=>e(this,null,(function*(){sessionStorage.setItem("system_open_keys",JSON.stringify([...s.value]));const e=yield c();m.value=b(e);const a=sessionStorage.getItem("system_open_keys");s.value=new Set(JSON.parse(a))}));o((()=>p()));const v=()=>{a.value=!1,n.value=!1,r.value={autoid:0,node_name:"",node_desc:"",node_path:"",node_sort:0,is_show:1,parent_id:0},m.value=[],p()};return{add:e=>{let l=0;"object"==typeof e&&(3===e.node_type&&(r.value.is_show=0),l=e.autoid),r.value.parent_id=l,a.value=!0},edit:a=>e(this,null,(function*(){n.value=!0,r.value=a,r.value.node_id=a.autoid})),del:a=>{d.confirm("确认删除该节点？","提示",{type:"warning"}).then((()=>e(this,null,(function*(){yield _(a.autoid),t.success("节点删除成功！"),p()})))).catch((()=>null))},sure:()=>e(this,null,(function*(){a.value?(yield f(r.value),t.success("节点添加成功！")):n.value&&(yield h(r.value),t.success("节点修改成功！")),v()})),clear:v,form:r,tableData:m,isAdd:a,isEdit:n,expandKeys:s,expandChange:(...e)=>{const[a,l]=e,o=a.autoid;if(l)s.value.add(o+"");else{i([a],1).forEach((e=>s.value.delete(e)))}}}}});const V={class:"index"},g={class:"caozuoFat"},x=p("添加一级节点"),C=p("编辑"),k=p("删除"),U=p("添加子节点"),S=p("隐藏"),E=p("显示");y.render=function(e,a,l,o,d,t){const p=n("el-button"),c=n("el-table-column"),_=n("el-switch"),f=n("el-table"),h=n("el-input"),v=n("el-form-item"),b=n("el-radio"),w=n("el-form"),y=n("young-dialog");return s(),u("div",V,[i("div",g,[i(p,{type:"primary",size:"small",plain:"",onClick:a[1]||(a[1]=a=>e.add(0))},{default:r((()=>[x])),_:1})]),m(" 节点列表 "),i(f,{data:e.tableData,style:{width:"100%","margin-bottom":"20px"},size:"medium","tree-props":{children:"part",hasChildren:"hasChildren"},"row-key":"autoid","expand-row-keys":[...e.expandKeys],onExpandChange:e.expandChange},{default:r((()=>[i(c,{prop:"node_name",label:"节点名称",width:"240"}),i(c,{prop:"autoid",label:"ID"}),i(c,{prop:"parent_id",label:"父节点"}),i(c,{prop:"node_path",label:"路径"}),i(c,{prop:"node_desc",label:"节点描述"}),i(c,{prop:"is_show",label:"隐藏/显示"},{default:r((e=>[i(_,{modelValue:e.row.is_show,"onUpdate:modelValue":a=>e.row.is_show=a,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),i(c,{prop:"node_type",label:"节点级别"}),i(c,{label:"操作",width:"300"},{default:r((a=>[i(p,{onClick:l=>e.edit(a.row)},{default:r((()=>[C])),_:2},1032,["onClick"]),i(p,{type:"danger",onClick:l=>e.del(a.row)},{default:r((()=>[k])),_:2},1032,["onClick"]),a.row.node_type<4?(s(),u(p,{key:0,type:"success",plain:"",onClick:l=>e.add(a.row)},{default:r((()=>[U])),_:2},1032,["onClick"])):m("v-if",!0)])),_:1})])),_:1},8,["data","expand-row-keys","onExpandChange"]),m(" 添加 / 编辑 "),i(y,{width:"370px","is-add":e.isAdd,"is-edit":e.isEdit,onSure:e.sure,onClear:e.clear},{body:r((()=>[i(w,{model:e.form,"label-width":"80px"},{default:r((()=>[i(v,{label:"节点名称"},{default:r((()=>[i(h,{modelValue:e.form.node_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.node_name=a)},null,8,["modelValue"])])),_:1}),i(v,{label:"节点描述"},{default:r((()=>[i(h,{modelValue:e.form.node_desc,"onUpdate:modelValue":a[3]||(a[3]=a=>e.form.node_desc=a)},null,8,["modelValue"])])),_:1}),i(v,{label:"节点路径"},{default:r((()=>[i(h,{modelValue:e.form.node_path,"onUpdate:modelValue":a[4]||(a[4]=a=>e.form.node_path=a)},null,8,["modelValue"])])),_:1}),i(v,{label:"排序(升序)"},{default:r((()=>[i(h,{modelValue:e.form.node_sort,"onUpdate:modelValue":a[5]||(a[5]=a=>e.form.node_sort=a),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),i(v,{label:"显示|隐藏"},{default:r((()=>[i(b,{modelValue:e.form.is_show,"onUpdate:modelValue":a[6]||(a[6]=a=>e.form.is_show=a),label:0},{default:r((()=>[S])),_:1},8,["modelValue"]),i(b,{modelValue:e.form.is_show,"onUpdate:modelValue":a[7]||(a[7]=a=>e.form.is_show=a),label:1},{default:r((()=>[E])),_:1},8,["modelValue"])])),_:1}),i(v,{label:"父节点ID"},{default:r((()=>[i(h,{modelValue:e.form.parent_id,"onUpdate:modelValue":a[8]||(a[8]=a=>e.form.parent_id=a),disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["is-add","is-edit","onSure","onClear"])])};export default y;
