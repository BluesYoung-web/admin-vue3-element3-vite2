import{d as e,r as t,v as l,x as a,Q as n,p as s,k as i,a as o,b as u,e as r,g as d,u as c,h as m,i as p,F as g,f as v,y as f,s as h,z as y,l as k,q as b}from"./index.e41ca46c.js";import"./vendor.7f0cd297.js";var x=e({name:"YoungImgUpload",props:{limit:{type:Number,default:10},comTask:{type:Object,default:()=>({})},imgs:{type:Object,required:!0},showUpload:{type:Boolean,default:!0}},emits:["update:imgs","did"],setup(e,{emit:s}){let i=t(!1),o=t(!1),u=t(0),r=t(0),d="";const c=t(null),m=[],p=()=>o.value=!1;l((()=>o.value),(e=>{e?document.body.addEventListener("click",p):document.body.removeEventListener("click",p)}));const g=t=>{var l;const a=null!=(l=t.target.files)?l:[];e.imgs.length+a.length>e.limit?n.warning(`最多只能上传${e.limit}张`):s("update:imgs",e.imgs.concat(Array.from(a).map((e=>(m.push(e),URL.createObjectURL(e))))))};return{addedListener:i,visible:o,top:u,left:r,toBeDel:d,imgRef:c,choseImg:()=>{!i.value&&c.value.addEventListener("change",g)&&(i.value=!0),c.value.click()},openMenu:(e,t)=>{d=t;r.value=e.clientX-105-120,u.value=e.clientY,o.value=!0},del:()=>{const t=e.imgs.indexOf(d);m.splice(t,1),e.imgs.splice(t,1),s("update:imgs",e.imgs),o.value=!1},uploadHandler:()=>{return t=this,l=null,n=function*(){const t=new FormData;m.forEach(((e,l)=>t.append("img"+l,e)));const l=yield a(e.comTask,t);s("did",l)},new Promise(((e,a)=>{var s=e=>{try{o(n.next(e))}catch(t){a(t)}},i=e=>{try{o(n.throw(e))}catch(t){a(t)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,i);o((n=n.apply(t,l)).next())}));var t,l,n}}}});const w=k("data-v-6e5f80a4");s("data-v-6e5f80a4");const U={class:"upload"},C=c("上传");i();const I=w(((e,t,l,a,n,s)=>{const i=o("el-button"),k=o("el-image");return u(),r("div",U,[d("input",{ref:"imgRef",type:"file",name:"img",multiple:e.limit>1,hidden:""},null,8,["multiple"]),d("div",null,[e.showUpload?(u(),r(i,{key:0,type:"primary",icon:"el-icon-picture",disabled:e.imgs.length>=10,onClick:e.choseImg},{default:w((()=>[c(" 点击选取图片（不超过"+m(e.limit)+"张） ",1)])),_:1},8,["disabled","onClick"])):p("",!0),d(i,{type:"success",icon:"el-icon-upload",onClick:e.uploadHandler},{default:w((()=>[C])),_:1},8,["onClick"])]),(u(!0),r(g,null,v(e.imgs,((t,l)=>(u(),r(k,{key:t+"9527"+l,src:t,"preview-src-list":e.imgs,lazy:"",class:"img",onContextmenu:f((l=>e.openMenu(l,t)),["prevent"])},null,8,["src","preview-src-list","onContextmenu"])))),128)),h(d("ul",{style:{left:e.left+"px",top:e.top+"px"},class:"contextmenu"},[d("li",{onClick:t[1]||(t[1]=(...t)=>e.del&&e.del(...t))},"删除")],4),[[y,e.visible]])])}));x.render=I,x.__scopeId="data-v-6e5f80a4";var L=e({name:"ImgUpload",components:{YoungImgUpload:x},setup(){let e=t([]),l=t([]);for(let t=0;t<10;t++)l.value.push({top:100+Math.floor(600*Math.random()),start:1700+Math.floor(3e3*Math.random()),color:"gray"});return{danmus:l,imgs:e}}});L.render=function(e,t,l,a,n,s){const i=o("young-img-upload"),c=b("pin");return u(),r(g,null,[(u(!0),r(g,null,v(e.danmus,((e,t)=>(u(),r("div",{key:t},[h(d("h1",null,"来了老弟",512),[[c,e]])])))),128)),d(i,{imgs:e.imgs,"onUpdate:imgs":t[1]||(t[1]=t=>e.imgs=t)},null,8,["imgs"])],64)};export default L;
