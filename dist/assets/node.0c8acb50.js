var e=(e,a,l)=>new Promise(((o,d)=>{var t=e=>{try{s(l.next(e))}catch(a){d(a)}},n=e=>{try{s(l.throw(e))}catch(a){d(a)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(t,n);s((l=l.apply(e,a)).next())}));import{e as a,_ as l,r as o,q as d,y as t,N as n,v as s,z as u,f as i,o as r,c as m,b as p,x as c,l as _,i as f}from"./index.2a5052c0.js";import{g as h,d as v,a as y,e as b}from"./system.b423b106.js";import"./vendor.7f0cd297.js";var w=a({name:"Node",components:{YoungDialog:l},setup(){let a=o(!1),l=o(!1);const i=o(new Set);let r=[];const m=(e,a)=>{1===a&&(r=[]);for(const l of e)r.push(l.autoid+""),u(l.part)&&l.part.length>0&&m(t(l.part));return r},p=o({autoid:0,node_name:"",node_desc:"",node_path:"",node_sort:0,is_show:1,parent_id:0});let c=o([]);const _=()=>e(this,null,(function*(){sessionStorage.setItem("system_open_keys",JSON.stringify([...i.value]));const e=yield h();c.value=t(e);const a=sessionStorage.getItem("system_open_keys");i.value=new Set(JSON.parse(a))}));d((()=>_()));const f=()=>{a.value=!1,l.value=!1,p.value={autoid:0,node_name:"",node_desc:"",node_path:"",node_sort:0,is_show:1,parent_id:0},c.value=[],_()};return{add:e=>{let l=0;"object"==typeof e&&(3===e.node_type&&(p.value.is_show=0),l=e.autoid),p.value.parent_id=l,a.value=!0},edit:a=>e(this,null,(function*(){l.value=!0,p.value=a,p.value.node_id=a.autoid})),del:a=>{n.confirm("确认删除该节点？","提示",{type:"warning"}).then((()=>e(this,null,(function*(){yield v(a.autoid),s.success("节点删除成功！"),_()})))).catch((()=>null))},sure:()=>e(this,null,(function*(){a.value?(yield y(p.value),s.success("节点添加成功！")):l.value&&(yield b(p.value),s.success("节点修改成功！")),f()})),clear:f,form:p,tableData:c,isAdd:a,isEdit:l,expandKeys:i,expandChange:(...e)=>{const[a,l]=e,o=a.autoid;if(l)i.value.add(o+"");else{m([a],1).forEach((e=>i.value.delete(e)))}}}}});const V={class:"index"},g={class:"caozuoFat"},x=f("添加一级节点"),C=f("编辑"),k=f("删除"),U=f("添加子节点"),S=f("隐藏"),E=f("显示");w.render=function(e,a,l,o,d,t){const n=i("el-button"),s=i("el-table-column"),u=i("el-switch"),f=i("el-table"),h=i("el-input"),v=i("el-form-item"),y=i("el-radio"),b=i("el-form"),w=i("young-dialog");return r(),m("div",V,[p("div",g,[p(n,{type:"primary",size:"small",plain:"",onClick:a[1]||(a[1]=a=>e.add(0))},{default:c((()=>[x])),_:1})]),_(" 节点列表 "),p(f,{data:e.tableData,style:{width:"100%","margin-bottom":"20px"},size:"medium","tree-props":{children:"part",hasChildren:"hasChildren"},"row-key":"autoid","expand-row-keys":[...e.expandKeys],onExpandChange:e.expandChange},{default:c((()=>[p(s,{prop:"node_name",label:"节点名称",width:"240"}),p(s,{prop:"autoid",label:"ID"}),p(s,{prop:"parent_id",label:"父节点"}),p(s,{prop:"node_path",label:"路径"}),p(s,{prop:"node_desc",label:"节点描述"}),p(s,{prop:"is_show",label:"隐藏/显示"},{default:c((e=>[p(u,{modelValue:e.row.is_show,"onUpdate:modelValue":a=>e.row.is_show=a,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),p(s,{prop:"node_type",label:"节点级别"}),p(s,{label:"操作",width:"300"},{default:c((a=>[p(n,{onClick:l=>e.edit(a.row)},{default:c((()=>[C])),_:2},1032,["onClick"]),p(n,{type:"danger",onClick:l=>e.del(a.row)},{default:c((()=>[k])),_:2},1032,["onClick"]),a.row.node_type<4?(r(),m(n,{key:0,type:"success",plain:"",onClick:l=>e.add(a.row)},{default:c((()=>[U])),_:2},1032,["onClick"])):_("v-if",!0)])),_:1})])),_:1},8,["data","expand-row-keys","onExpandChange"]),_(" 添加 / 编辑 "),p(w,{width:"370px","is-add":e.isAdd,"is-edit":e.isEdit,onSure:e.sure,onClear:e.clear},{body:c((()=>[p(b,{model:e.form,"label-width":"80px"},{default:c((()=>[p(v,{label:"节点名称"},{default:c((()=>[p(h,{modelValue:e.form.node_name,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.node_name=a)},null,8,["modelValue"])])),_:1}),p(v,{label:"节点描述"},{default:c((()=>[p(h,{modelValue:e.form.node_desc,"onUpdate:modelValue":a[3]||(a[3]=a=>e.form.node_desc=a)},null,8,["modelValue"])])),_:1}),p(v,{label:"节点路径"},{default:c((()=>[p(h,{modelValue:e.form.node_path,"onUpdate:modelValue":a[4]||(a[4]=a=>e.form.node_path=a)},null,8,["modelValue"])])),_:1}),p(v,{label:"排序(升序)"},{default:c((()=>[p(h,{modelValue:e.form.node_sort,"onUpdate:modelValue":a[5]||(a[5]=a=>e.form.node_sort=a),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),p(v,{label:"显示|隐藏"},{default:c((()=>[p(y,{modelValue:e.form.is_show,"onUpdate:modelValue":a[6]||(a[6]=a=>e.form.is_show=a),label:0},{default:c((()=>[S])),_:1},8,["modelValue"]),p(y,{modelValue:e.form.is_show,"onUpdate:modelValue":a[7]||(a[7]=a=>e.form.is_show=a),label:1},{default:c((()=>[E])),_:1},8,["modelValue"])])),_:1}),p(v,{label:"父节点ID"},{default:c((()=>[p(h,{modelValue:e.form.parent_id,"onUpdate:modelValue":a[8]||(a[8]=a=>e.form.parent_id=a),disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["is-add","is-edit","onSure","onClear"])])};export default w;
