import{d as e,g as l,B as t,b as a,p as n,a as s,h as i,o,c as u,u as r,e as d,n as c,k as m,F as p,i as g,z as v,q as f,v as h,w as y,U as b}from"./vendor.51bba142.js";import{u as k}from"./index.eb0a6236.js";var x=e({name:"YoungImgUpload",props:{limit:{type:Number,default:10},comTask:{type:Object,default:()=>({})},imgs:{type:Object,required:!0},showUpload:{type:Boolean,default:!0}},emits:["update:imgs","did"],setup(e,{emit:n}){let s=l(!1),i=l(!1),o=l(0),u=l(0),r="";const d=l(null),c=[],m=()=>i.value=!1;t((()=>{i.value?document.body.addEventListener("click",m):document.body.removeEventListener("click",m)}));const p=l=>{var t;const s=null!=(t=l.target.files)?t:[];e.imgs.length+s.length>e.limit?a.warning(`最多只能上传${e.limit}张`):n("update:imgs",e.imgs.concat(Array.from(s).map((e=>(c.push(e),URL.createObjectURL(e))))))};return{addedListener:s,visible:i,top:o,left:u,toBeDel:r,imgRef:d,choseImg:()=>{!s.value&&d.value.addEventListener("change",p)&&(s.value=!0),d.value.click()},openMenu:(e,l)=>{r=l;u.value=e.clientX-105-120,o.value=e.clientY,i.value=!0},del:()=>{const l=e.imgs.indexOf(r);c.splice(l,1),e.imgs.splice(l,1),n("update:imgs",e.imgs),i.value=!1},uploadHandler:()=>{return l=this,t=null,a=function*(){const l=new FormData;c.forEach(((e,t)=>l.append("img"+t,e)));const t=yield k(e.comTask,l);n("did",t)},new Promise(((e,n)=>{var s=e=>{try{o(a.next(e))}catch(l){n(l)}},i=e=>{try{o(a.throw(e))}catch(l){n(l)}},o=l=>l.done?e(l.value):Promise.resolve(l.value).then(s,i);o((a=a.apply(l,t)).next())}));var l,t,a}}}});const w=y();n("data-v-d0269bc2");const U={class:"upload"},C=c("上传");s();const I=w(((e,l,t,a,n,s)=>{const y=i("el-button"),b=i("el-image");return o(),u(p,null,[r(" 图片上传组件 "),d("div",U,[d("input",{ref:"imgRef",type:"file",name:"img",multiple:e.limit>1,hidden:""},null,8,["multiple"]),d("div",null,[e.showUpload?(o(),u(y,{key:0,type:"primary",icon:"el-icon-picture",disabled:e.imgs.length>=10,onClick:e.choseImg},{default:w((()=>[c(" 点击选取图片（不超过"+m(e.limit)+"张） ",1)])),_:1},8,["disabled","onClick"])):r("v-if",!0),d(y,{type:"success",icon:"el-icon-upload",onClick:e.uploadHandler},{default:w((()=>[C])),_:1},8,["onClick"])]),(o(!0),u(p,null,g(e.imgs,((l,t)=>(o(),u(b,{key:l+"9527"+t,src:l,"preview-src-list":e.imgs,lazy:"",class:"img",onContextmenu:v((t=>e.openMenu(t,l)),["prevent"])},null,8,["src","preview-src-list","onContextmenu"])))),128)),f(d("ul",{style:{left:e.left+"px",top:e.top+"px"},class:"contextmenu"},[d("li",{onClick:l[1]||(l[1]=(...l)=>e.del&&e.del(...l))},"删除")],4),[[h,e.visible]])])],2112)}));x.render=I,x.__scopeId="data-v-d0269bc2";var L=e({name:"ImgUpload",components:{YoungImgUpload:x},setup(){let e=l([]),t=l([]);for(let l=0;l<10;l++)t.value.push({top:100+Math.floor(600*Math.random()),start:1700+Math.floor(3e3*Math.random()),color:"gray"});return{danmus:t,imgs:e}}});L.render=function(e,l,t,a,n,s){const r=i("young-img-upload"),c=b("pin");return o(),u(p,null,[(o(!0),u(p,null,g(e.danmus,((e,l)=>(o(),u("div",{key:l},[f(d("h1",null,"来了老弟",512),[[c,e]])])))),128)),d(r,{imgs:e.imgs,"onUpdate:imgs":l[1]||(l[1]=l=>e.imgs=l)},null,8,["imgs"])],64)};export default L;
