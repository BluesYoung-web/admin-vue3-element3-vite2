var e=(e,l,a)=>new Promise(((o,d)=>{var t=e=>{try{s(a.next(e))}catch(l){d(l)}},i=e=>{try{s(a.throw(e))}catch(l){d(l)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(t,i);s((a=a.apply(e,l)).next())}));import{d as l,f as a,D as o,V as d,y as t,p as i,a as s,g as n,o as r,c as u,b as c,u as p,m,i as f,w as _}from"./vendor.a879550b.js";import{b as h,c as v,f as b,h as y,i as V}from"./system.3f7229c8.js";import{_ as w,d as I}from"./index.f0a1825a.js";var k=l({name:"Role",components:{YoungDialog:w},setup(){let l=a({autoid:0,role_name:"",role_desc:"",parent_role_id:0,is_enable:1,platform_type:0,role_access:""}),i=a([]),s=a([]),n=a(!1),r=a(!1),u=a(!1);const c=()=>e(this,null,(function*(){const e=yield h();i.value=I(e)}));o((()=>c()));const p=()=>{n.value=!1,r.value=!1,u.value=!1,l.value={autoid:0,role_name:"",role_desc:"",role_access:"",parent_role_id:0,is_enable:1,platform_type:0},i.value=[],c()},m=()=>e(this,null,(function*(){n.value?(yield y(l.value),t.success("角色添加成功！")):(yield V(l.value),t.success("角色修改成功！")),p()})),f=(e,l=!1)=>{0!==e.part.length&&e.part.forEach((a=>{l?a.is_checked?a.is_checked=!0:a.is_checked=!1:e.is_checked?a.is_checked=!0:a.is_checked=!1,f(a,l)}))},_=(e,l)=>{0!==e.length&&e.forEach((e=>{e.is_checked&&l.add(e.autoid),_(e.part,l)}))};return{tableData:i,nodeList:s,formInfo:l,isAddInfo:n,isEditInfo:r,isEditPriority:u,add:()=>e(this,null,(function*(){n.value=!0})),editInfo:e=>{l.value=e,r.value=!0},editPriority:a=>e(this,null,(function*(){const e=yield v(a.autoid);let o=yield e.nodeList;o.forEach((e=>{e.is_checked&&(e.is_checked=!0),f(e,!0)})),s.value=I(o),l.value=a,u.value=!0})),del:l=>{d.confirm("确认删除该角色？","提示",{type:"warning"}).then((()=>e(this,null,(function*(){yield b(l.autoid),t.success("删除成功！"),c()})))).catch((()=>null))},sure:m,clear:p,selectChange:f,surePriority:()=>{const e=new Set;_(s.value,e),l.value.role_access=[...e].join(","),m()}}}});const C=_();i("data-v-15e4ada8");const g={class:"index"},U={class:"caozuoFat"},F=m("添加角色"),E=m("信息编辑"),x=m("权限编辑"),P=m("删除"),D={class:"tjglyFat"},j={class:"disF"},S=c("span",null,"角色名称",-1),z={class:"disF"},L=c("span",null,"角色描述",-1),A={class:"disF"},H=c("span",null,"父级角色id",-1),M={class:"disF"},R=c("span",null,"禁用|启用",-1),Y={class:"mar7"},q=m("禁用"),B=m("启用"),G={class:"disF"},J=c("span",null,"选择后台",-1),K={class:"mar7"},N=m("管理后台"),O=m("商户后台"),Q={class:"tjglyFat checkssss pd"};s();const T=C(((e,l,a,o,d,t)=>{const i=n("el-button"),s=n("el-table-column"),_=n("el-switch"),h=n("el-table"),v=n("el-input"),b=n("el-radio"),y=n("young-dialog"),V=n("el-checkbox");return r(),u("div",g,[c("div",U,[c(i,{type:"primary",size:"small",plain:"",onClick:e.add},{default:C((()=>[F])),_:1},8,["onClick"])]),p(" 角色列表 "),c(h,{data:e.tableData,style:{width:"100%"},size:"medium",height:"700",class:"tableHet"},{default:C((()=>[c(s,{prop:"autoid",label:"ID"}),c(s,{prop:"parent_role_id",label:"父角色ID"}),c(s,{prop:"role_name",label:"角色名称"}),c(s,{prop:"role_desc",label:"角色描述"}),c(s,{label:"不启用/启用"},{default:C((e=>[c(_,{modelValue:e.row.is_enable,"onUpdate:modelValue":l=>e.row.is_enable=l,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),c(s,{label:"操作",width:"300"},{default:C((l=>[c(i,{onClick:a=>e.editInfo(l.row)},{default:C((()=>[E])),_:2},1032,["onClick"]),c(i,{onClick:a=>e.editPriority(l.row),type:"primary",plain:""},{default:C((()=>[x])),_:2},1032,["onClick"]),1!=+l.row.autoid?(r(),u(i,{key:0,type:"danger",onClick:a=>e.del(l.row)},{default:C((()=>[P])),_:2},1032,["onClick"])):p("v-if",!0)])),_:1})])),_:1},8,["data"]),p(" 信息 添加 | 编辑 "),c(y,{width:"370px","is-add":e.isAddInfo,"is-edit":e.isEditInfo,onSure:e.sure,onClear:e.clear},{body:C((()=>[c("div",D,[c("div",j,[S,c(v,{modelValue:e.formInfo.role_name,"onUpdate:modelValue":l[1]||(l[1]=l=>e.formInfo.role_name=l),class:"len"},null,8,["modelValue"])]),c("div",z,[L,c(v,{modelValue:e.formInfo.role_desc,"onUpdate:modelValue":l[2]||(l[2]=l=>e.formInfo.role_desc=l),class:"len"},null,8,["modelValue"])]),c("div",A,[H,c(v,{modelValue:e.formInfo.parent_role_id,"onUpdate:modelValue":l[3]||(l[3]=l=>e.formInfo.parent_role_id=l),modelModifiers:{number:!0},disabled:e.isEditInfo,class:"len"},null,8,["modelValue","disabled"])]),c("div",M,[R,c("div",Y,[c(b,{modelValue:e.formInfo.is_enable,"onUpdate:modelValue":l[4]||(l[4]=l=>e.formInfo.is_enable=l),label:0},{default:C((()=>[q])),_:1},8,["modelValue"]),c(b,{modelValue:e.formInfo.is_enable,"onUpdate:modelValue":l[5]||(l[5]=l=>e.formInfo.is_enable=l),label:1},{default:C((()=>[B])),_:1},8,["modelValue"])])]),c("div",G,[J,c("div",K,[c(b,{modelValue:e.formInfo.platform_type,"onUpdate:modelValue":l[6]||(l[6]=l=>e.formInfo.platform_type=l),label:0},{default:C((()=>[N])),_:1},8,["modelValue"]),c(b,{modelValue:e.formInfo.platform_type,"onUpdate:modelValue":l[7]||(l[7]=l=>e.formInfo.platform_type=l),label:1},{default:C((()=>[O])),_:1},8,["modelValue"])])])])])),_:1},8,["is-add","is-edit","onSure","onClear"]),p(" 权限编辑 "),c(y,{width:"60vw",top:"10vh","is-edit":e.isEditPriority,onSure:e.surePriority,onClear:e.clear},{body:C((()=>[c("div",Q,[c(h,{data:e.nodeList,style:{width:"100%","margin-bottom":"20px"},"row-key":"autoid","default-expand-all":!1,size:"medium","tree-props":{children:"part",hasChildren:"hasChildren"}},{default:C((()=>[c(s,{prop:"node_name",label:"节点名称",width:"240"},{default:C((l=>[c(V,{modelValue:l.row.is_checked,"onUpdate:modelValue":e=>l.row.is_checked=e,onChange:a=>e.selectChange(l.row)},{default:C((()=>[m(f(l.row.node_name),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),c(s,{prop:"autoid",label:"ID"}),c(s,{prop:"parent_id",label:"父节点"}),c(s,{prop:"node_path",label:"路径"}),c(s,{prop:"node_desc",label:"节点描述"}),c(s,{prop:"is_show",label:"隐藏/显示"},{default:C((e=>[c(_,{modelValue:e.row.is_show,"onUpdate:modelValue":l=>e.row.is_show=l,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),c(s,{prop:"node_type",label:"节点级别"})])),_:1},8,["data"])])])),_:1},8,["is-edit","onSure","onClear"])])}));k.render=T,k.__scopeId="data-v-15e4ada8";export default k;
