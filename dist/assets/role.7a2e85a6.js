var e=(e,l,a)=>new Promise(((o,d)=>{var t=e=>{try{n(a.next(e))}catch(l){d(l)}},i=e=>{try{n(a.throw(e))}catch(l){d(l)}},n=e=>e.done?o(e.value):Promise.resolve(e.value).then(t,i);n((a=a.apply(e,l)).next())}));import{d as l,f as a,I as o,F as d,S as t,p as i,a as n,g as s,o as r,c as u,b as c,x as p,q as m,k as f,w as _}from"./vendor.10417c21.js";import{b as v,c as h,f as b,h as y,i as V}from"./system.dba4bdfc.js";import{a as w,d as I}from"./index.835f1048.js";var k=l({name:"Role",components:{YoungDialog:w},setup(){let l=a({autoid:0,role_name:"",role_desc:"",parent_role_id:0,is_enable:1,platform_type:0,role_access:""}),i=a([]),n=a([]),s=a(!1),r=a(!1),u=a(!1);const c=()=>e(this,null,(function*(){const e=yield v();i.value=I(e)}));o((()=>c()));const p=new Map,m=e=>{for(const l of e)p.set(l.autoid,l),l.part.length>0&&m(l.part)},f=()=>{s.value=!1,r.value=!1,u.value=!1,l.value={autoid:0,role_name:"",role_desc:"",role_access:"",parent_role_id:0,is_enable:1,platform_type:0},i.value=[],c()},_=()=>e(this,null,(function*(){s.value?(yield y(l.value),t.success("角色添加成功！")):(yield V(l.value),t.success("角色修改成功！")),f()})),w=e=>{if(0!==e.part.length&&e.part.forEach((l=>{l.is_checked=e.is_checked,w(l)})),e.is_checked)for(;e.parent_id;){const l=p.get(e.parent_id);if(!l)break;(e=l)&&(e.is_checked=1)}},k=(e,l)=>{0!==e.length&&e.forEach((e=>{e.is_checked&&l.add(e.autoid),k(e.part,l)}))};return{tableData:i,nodeList:n,formInfo:l,isAddInfo:s,isEditInfo:r,isEditPriority:u,add:()=>e(this,null,(function*(){s.value=!0})),editInfo:e=>{l.value=e,r.value=!0},editPriority:a=>e(this,null,(function*(){const e=yield h(a.autoid);let o=yield e.nodeList;n.value=I(o),m(n.value),l.value=a,u.value=!0})),del:l=>{d.confirm("确认删除该角色？","提示",{type:"warning"}).then((()=>e(this,null,(function*(){yield b(l.autoid),t.success("删除成功！"),c()})))).catch((()=>null))},sure:_,clear:f,selectChange:w,surePriority:()=>{const e=new Set;k(n.value,e),l.value.role_access=[...e].join(","),_()}}}});const g=_();i("data-v-15e4ada8");const C={class:"index"},F={class:"caozuoFat"},U=m("添加角色"),x=m("信息编辑"),E=m("权限编辑"),P=m("删除"),j={class:"tjglyFat"},D={class:"disF"},S=c("span",null,"角色名称",-1),z={class:"disF"},L=c("span",null,"角色描述",-1),A={class:"disF"},M=c("span",null,"父级角色id",-1),q={class:"disF"},H=c("span",null,"禁用|启用",-1),R={class:"mar7"},Y=m("禁用"),B=m("启用"),G={class:"disF"},J=c("span",null,"选择后台",-1),K={class:"mar7"},N=m("管理后台"),O=m("商户后台"),Q={class:"tjglyFat checkssss pd"};n();const T=g(((e,l,a,o,d,t)=>{const i=s("el-button"),n=s("el-table-column"),_=s("el-switch"),v=s("el-table"),h=s("el-input"),b=s("el-radio"),y=s("young-dialog"),V=s("el-checkbox");return r(),u("div",C,[c("div",F,[c(i,{type:"primary",size:"small",plain:"",onClick:e.add},{default:g((()=>[U])),_:1},8,["onClick"])]),p(" 角色列表 "),c(v,{data:e.tableData,style:{width:"100%"},size:"medium",height:"700",class:"tableHet"},{default:g((()=>[c(n,{prop:"autoid",label:"ID"}),c(n,{prop:"parent_role_id",label:"父角色ID"}),c(n,{prop:"role_name",label:"角色名称"}),c(n,{prop:"role_desc",label:"角色描述"}),c(n,{label:"不启用/启用"},{default:g((e=>[c(_,{modelValue:e.row.is_enable,"onUpdate:modelValue":l=>e.row.is_enable=l,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),c(n,{label:"操作",width:"300"},{default:g((l=>[c(i,{onClick:a=>e.editInfo(l.row)},{default:g((()=>[x])),_:2},1032,["onClick"]),c(i,{onClick:a=>e.editPriority(l.row),type:"primary",plain:""},{default:g((()=>[E])),_:2},1032,["onClick"]),1!=+l.row.autoid?(r(),u(i,{key:0,type:"danger",onClick:a=>e.del(l.row)},{default:g((()=>[P])),_:2},1032,["onClick"])):p("v-if",!0)])),_:1})])),_:1},8,["data"]),p(" 信息 添加 | 编辑 "),c(y,{width:"370px","is-add":e.isAddInfo,"is-edit":e.isEditInfo,onSure:e.sure,onClear:e.clear},{body:g((()=>[c("div",j,[c("div",D,[S,c(h,{modelValue:e.formInfo.role_name,"onUpdate:modelValue":l[1]||(l[1]=l=>e.formInfo.role_name=l),class:"len"},null,8,["modelValue"])]),c("div",z,[L,c(h,{modelValue:e.formInfo.role_desc,"onUpdate:modelValue":l[2]||(l[2]=l=>e.formInfo.role_desc=l),class:"len"},null,8,["modelValue"])]),c("div",A,[M,c(h,{modelValue:e.formInfo.parent_role_id,"onUpdate:modelValue":l[3]||(l[3]=l=>e.formInfo.parent_role_id=l),modelModifiers:{number:!0},disabled:e.isEditInfo,class:"len"},null,8,["modelValue","disabled"])]),c("div",q,[H,c("div",R,[c(b,{modelValue:e.formInfo.is_enable,"onUpdate:modelValue":l[4]||(l[4]=l=>e.formInfo.is_enable=l),label:0},{default:g((()=>[Y])),_:1},8,["modelValue"]),c(b,{modelValue:e.formInfo.is_enable,"onUpdate:modelValue":l[5]||(l[5]=l=>e.formInfo.is_enable=l),label:1},{default:g((()=>[B])),_:1},8,["modelValue"])])]),c("div",G,[J,c("div",K,[c(b,{modelValue:e.formInfo.platform_type,"onUpdate:modelValue":l[6]||(l[6]=l=>e.formInfo.platform_type=l),label:0},{default:g((()=>[N])),_:1},8,["modelValue"]),c(b,{modelValue:e.formInfo.platform_type,"onUpdate:modelValue":l[7]||(l[7]=l=>e.formInfo.platform_type=l),label:1},{default:g((()=>[O])),_:1},8,["modelValue"])])])])])),_:1},8,["is-add","is-edit","onSure","onClear"]),p(" 权限编辑 "),c(y,{width:"60vw",top:"10vh","is-edit":e.isEditPriority,onSure:e.surePriority,onClear:e.clear},{body:g((()=>[c("div",Q,[c(v,{data:e.nodeList,style:{width:"100%","margin-bottom":"20px"},"row-key":"autoid","default-expand-all":!1,size:"medium","tree-props":{children:"part",hasChildren:"hasChildren"}},{default:g((()=>[c(n,{prop:"node_name",label:"节点名称",width:"240"},{default:g((l=>[c(V,{modelValue:l.row.is_checked,"onUpdate:modelValue":e=>l.row.is_checked=e,"true-label":1,"false-label":0,onChange:a=>e.selectChange(l.row)},{default:g((()=>[m(f(l.row.node_name),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),c(n,{prop:"autoid",label:"ID"}),c(n,{prop:"parent_id",label:"父节点"}),c(n,{prop:"node_path",label:"路径"}),c(n,{prop:"node_desc",label:"节点描述"}),c(n,{prop:"is_show",label:"隐藏/显示"},{default:g((e=>[c(_,{modelValue:e.row.is_show,"onUpdate:modelValue":l=>e.row.is_show=l,"active-value":1,"inactive-value":0,"active-color":"#409EFF","inactive-color":"#909399",disabled:""},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),c(n,{prop:"node_type",label:"节点级别"})])),_:1},8,["data"])])])),_:1},8,["is-edit","onSure","onClear"])])}));k.render=T,k.__scopeId="data-v-15e4ada8";export default k;
