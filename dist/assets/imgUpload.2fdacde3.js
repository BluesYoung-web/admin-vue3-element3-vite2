import{u as e,Q as a}from"./index.01dedd60.js";import{d as t,f as l,w as n,a1 as s,a2 as i,Y as o,W as u,b as d,e as r,L as m,p as c,k as p,F as g,D as v,l as f,A as h,J as y,a3 as k,Z as b}from"./vendor.480fa8ef.js";var x=t({name:"YoungImgUpload",props:{limit:{type:Number,default:10},comTask:{type:Object,default:()=>({})},imgs:{type:Object,required:!0},showUpload:{type:Boolean,default:!0}},emits:["update:imgs","did"],setup(t,{emit:s}){let i=l(!1),o=l(!1),u=l(0),d=l(0),r="";const m=l(null),c=[],p=()=>o.value=!1;n((()=>o.value),(e=>{e?document.body.addEventListener("click",p):document.body.removeEventListener("click",p)}));const g=e=>{var l;const n=null!=(l=e.target.files)?l:[];t.imgs.length+n.length>t.limit?a.warning(`最多只能上传${t.limit}张`):s("update:imgs",t.imgs.concat(Array.from(n).map((e=>(c.push(e),URL.createObjectURL(e))))))};return{addedListener:i,visible:o,top:u,left:d,toBeDel:r,imgRef:m,choseImg:()=>{!i.value&&m.value.addEventListener("change",g)&&(i.value=!0),m.value.click()},openMenu:(e,a)=>{r=a;d.value=e.clientX-105-120,u.value=e.clientY,o.value=!0},del:()=>{const e=t.imgs.indexOf(r);c.splice(e,1),t.imgs.splice(e,1),s("update:imgs",t.imgs),o.value=!1},uploadHandler:()=>{return a=this,l=null,n=function*(){const a=new FormData;c.forEach(((e,t)=>a.append("img"+t,e)));const l=yield e(t.comTask,a);s("did",l)},new Promise(((e,t)=>{var s=e=>{try{o(n.next(e))}catch(a){t(a)}},i=e=>{try{o(n.throw(e))}catch(a){t(a)}},o=a=>a.done?e(a.value):Promise.resolve(a.value).then(s,i);o((n=n.apply(a,l)).next())}));var a,l,n}}}});const w=k("data-v-6e5f80a4");s("data-v-6e5f80a4");const U={class:"upload"},C=m("上传");i();const L=w(((e,a,t,l,n,s)=>{const i=o("el-button"),k=o("el-image");return u(),d("div",U,[r("input",{ref:"imgRef",type:"file",name:"img",multiple:e.limit>1,hidden:""},null,8,["multiple"]),r("div",null,[e.showUpload?(u(),d(i,{key:0,type:"primary",icon:"el-icon-picture",disabled:e.imgs.length>=10,onClick:e.choseImg},{default:w((()=>[m(" 点击选取图片（不超过"+c(e.limit)+"张） ",1)])),_:1},8,["disabled","onClick"])):p("",!0),r(i,{type:"success",icon:"el-icon-upload",onClick:e.uploadHandler},{default:w((()=>[C])),_:1},8,["onClick"])]),(u(!0),d(g,null,v(e.imgs,((a,t)=>(u(),d(k,{key:a+"9527"+t,src:a,"preview-src-list":e.imgs,lazy:"",class:"img",onContextmenu:f((t=>e.openMenu(t,a)),["prevent"])},null,8,["src","preview-src-list","onContextmenu"])))),128)),h(r("ul",{style:{left:e.left+"px",top:e.top+"px"},class:"contextmenu"},[r("li",{onClick:a[1]||(a[1]=(...a)=>e.del&&e.del(...a))},"删除")],4),[[y,e.visible]])])}));x.render=L,x.__scopeId="data-v-6e5f80a4";var I=t({name:"ImgUpload",components:{YoungImgUpload:x},setup(){let e=l([]),a=l([]);for(let t=0;t<100;t++)a.value.push({top:100+Math.floor(600*Math.random()),start:1700+Math.floor(3e3*Math.random()),color:"gray"});return{danmus:a,imgs:e}}});I.render=function(e,a,t,l,n,s){const i=o("young-img-upload"),m=b("pin");return u(),d(g,null,[(u(!0),d(g,null,v(e.danmus,((e,a)=>(u(),d("div",{key:a},[h(r("h1",null,"来了老弟"+c(a),513),[[m,e]])])))),128)),r(i,{imgs:e.imgs,"onUpdate:imgs":a[1]||(a[1]=a=>e.imgs=a)},null,8,["imgs"])],64)};export default I;
