import{e,r as l,j as t,k as a,v as n,p as s,a as i,f as o,o as d,c as u,l as r,b as c,i as m,t as p,F as g,m as v,w as f,h,n as y,d as b,g as k}from"./index.40dbd85e.js";import"./vendor.7f0cd297.js";var x=e({name:"YoungImgUpload",props:{limit:{type:Number,default:10},comTask:{type:Object,default:()=>({})},imgs:{type:Object,required:!0},showUpload:{type:Boolean,default:!0}},emits:["update:imgs","did"],setup(e,{emit:s}){let i=l(!1),o=l(!1),d=l(0),u=l(0),r="";const c=l(null),m=[],p=()=>o.value=!1;t((()=>{o.value?document.body.addEventListener("click",p):document.body.removeEventListener("click",p)}));const g=l=>{var t;const a=null!=(t=l.target.files)?t:[];e.imgs.length+a.length>e.limit?n.warning(`最多只能上传${e.limit}张`):s("update:imgs",e.imgs.concat(Array.from(a).map((e=>(m.push(e),URL.createObjectURL(e))))))};return{addedListener:i,visible:o,top:d,left:u,toBeDel:r,imgRef:c,choseImg:()=>{!i.value&&c.value.addEventListener("change",g)&&(i.value=!0),c.value.click()},openMenu:(e,l)=>{r=l;u.value=e.clientX-105-120,d.value=e.clientY,o.value=!0},del:()=>{const l=e.imgs.indexOf(r);m.splice(l,1),e.imgs.splice(l,1),s("update:imgs",e.imgs),o.value=!1},uploadHandler:()=>{return l=this,t=null,n=function*(){const l=new FormData;m.forEach(((e,t)=>l.append("img"+t,e)));const t=yield a(e.comTask,l);s("did",t)},new Promise(((e,a)=>{var s=e=>{try{o(n.next(e))}catch(l){a(l)}},i=e=>{try{o(n.throw(e))}catch(l){a(l)}},o=l=>l.done?e(l.value):Promise.resolve(l.value).then(s,i);o((n=n.apply(l,t)).next())}));var l,t,n}}}});const w=b();s("data-v-d0269bc2");const U={class:"upload"},C=m("上传");i();const j=w(((e,l,t,a,n,s)=>{const i=o("el-button"),b=o("el-image");return d(),u(g,null,[r(" 图片上传组件 "),c("div",U,[c("input",{ref:"imgRef",type:"file",name:"img",multiple:e.limit>1,hidden:""},null,8,["multiple"]),c("div",null,[e.showUpload?(d(),u(i,{key:0,type:"primary",icon:"el-icon-picture",disabled:e.imgs.length>=10,onClick:e.choseImg},{default:w((()=>[m(" 点击选取图片（不超过"+p(e.limit)+"张） ",1)])),_:1},8,["disabled","onClick"])):r("v-if",!0),c(i,{type:"success",icon:"el-icon-upload",onClick:e.uploadHandler},{default:w((()=>[C])),_:1},8,["onClick"])]),(d(!0),u(g,null,v(e.imgs,((l,t)=>(d(),u(b,{key:l+"9527"+t,src:l,"preview-src-list":e.imgs,lazy:"",class:"img",onContextmenu:f((t=>e.openMenu(t,l)),["prevent"])},null,8,["src","preview-src-list","onContextmenu"])))),128)),h(c("ul",{style:{left:e.left+"px",top:e.top+"px"},class:"contextmenu"},[c("li",{onClick:l[1]||(l[1]=(...l)=>e.del&&e.del(...l))},"删除")],4),[[y,e.visible]])])],2112)}));x.render=j,x.__scopeId="data-v-d0269bc2";var I=e({name:"ImgUpload",components:{YoungImgUpload:x},setup(){let e=l([]),t=l([]);for(let l=0;l<10;l++)t.value.push({top:100+Math.floor(600*Math.random()),start:1700+Math.floor(3e3*Math.random()),color:"gray"});return{danmus:t,imgs:e}}});I.render=function(e,l,t,a,n,s){const i=o("young-img-upload"),r=k("pin");return d(),u(g,null,[(d(!0),u(g,null,v(e.danmus,((e,l)=>(d(),u("div",{key:l},[h(c("h1",null,"来了老弟",512),[[r,e]])])))),128)),c(i,{imgs:e.imgs,"onUpdate:imgs":l[1]||(l[1]=l=>e.imgs=l)},null,8,["imgs"])],64)};export default I;
